import React from 'react'
import axios from "axios";
import { useEffect, useState } from "react";

import Box from "@mui/material/Box";
import Grid from '@mui/material/Grid';

import NoDetails from '../NoDetails';
import ResultRow from "../../ResultRow";


// TODO: Implement API: https://bazaar.abuse.ch/api/#query_hash
export default function Malwarebazaar() {
    const [result, setResult] = useState(null);
    const [error, setError] = useState(null);
    const [loading, setLoading] = useState(true);

    useEffect(() => {
        const fetchData = async () => {
            setLoading(true);
            try {
                const url = 'http://localhost:8000/api/hash/malwarebazaar/' + props.ioc;
                const response = await axios.get(url);
                setResult(response.data);
            } catch (e) {
                setError(e);
            }
            setLoading(false);
        }
        fetchData();
    }, []);

    const details = (
        <>
            <NoDetails />
        </>
    )


  return (
    <>
      <ResultRow
        name="MalwareBazaar (abuse.ch)"
        id="malwarebazaar"
        icon="malwarebazaar_logo_small"
        loading={loading}
        result={result}
        summary={
            result && result['query_status'] === 'illegal_hash' ? "Malicious" : "Not Malicious"
        }
        summary_color={{ color: null }}
        color={
            result && result['query_status'] === 'illegal_hash' ? 'red' : 'green'
        }
        error={error}
        details={details}
      />
    </>
  )
}
